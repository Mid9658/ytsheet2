<!DOCTYPE html>
<html lang="ja">
<head>
  <TMPL_INCLUDE NAME="../_common/sheet-head.html">
  <link rel="stylesheet" media="all" href="<TMPL_VAR coreDir>/skin/nc/css/edit.css?<TMPL_VAR ver>">
  <script src="<TMPL_VAR coreDir>/skin/_common/js/lib/Sortable.min.js"></script>
  <script src="<TMPL_VAR coreDir>/skin/_common/js/lib/compressor.min.js"></script>
  <style>
    #image,
    .image-custom-view {
      background-image: url("<TMPL_VAR imageURL>");
    }
  </style>
</head>
<body>
<header>
  <h1><a href="./"><TMPL_VAR title></a></h1>
  <nav>
    <ul>
      <TMPL_LOOP Menu><li class="<TMPL_VAR SIZE>"><a <TMPL_VAR TYPE>="<TMPL_VAR VALUE>"><TMPL_VAR TEXT></a></TMPL_LOOP>
      <li><a onclick="nightModeChange()" class="nightmode-icon" title="ナイトモード"></a>
    </ul>
  </nav>
</header>
<div class="header-back-name"><TMPL_VAR titleName> - <TMPL_VAR title></div>
<main id="character">
<form name="sheet" id="edit-form" method="post" action="./" enctype="multipart/form-data">
<input type="hidden" name="mode" value="<TMPL_VAR mode>">
<TMPL_IF token><input type="hidden" name="_token" value="<TMPL_VAR token>"></TMPL_IF>
<input type="hidden" name="id" value="<TMPL_VAR id>">
<details class="box" id="edit-protect">
  <summary>編集権限</summary>
  <fieldset id="edit-protect-view">
    <input type="hidden" name="protectOld" value="<TMPL_VAR protectOld>">
    <TMPL_IF LOGIN_ID>
    <label><input type="radio" name="protect" value="account"<TMPL_IF protectAccount> checked</TMPL_IF>> アカウントに紐付ける（ログイン中のみ編集可能）</label><br>
    </TMPL_IF>
    <label><input type="radio" name="protect" value="password"<TMPL_IF protectPassword> checked</TMPL_IF>> パスワードで保護</label> <TMPL_IF passHidden><input type="hidden" name="pass" value="<TMPL_VAR pass>"><TMPL_ELSE><input type="password" name="pass"></TMPL_IF><br>
    <label><input type="radio" name="protect" value="none"<TMPL_IF protectNone> checked</TMPL_IF>> 保護しない（誰でも編集可能）</label>
  </fieldset>
</details>
<dl class="box" id="hide-options">
  <dt>閲覧可否設定</dt>
  <dd id="forbidden-checkbox">
    <select name="forbidden">
      <option value="">内容を全て開示
      <option value="battle" <TMPL_IF forbiddenBattle>selected</TMPL_IF>>データ・数値のみ秘匿
      <option value="all"    <TMPL_IF forbiddenAll>selected</TMPL_IF>>内容を全て秘匿
    </select>
  </dd>
  <dd id="hide-checkbox">
    <select name="hide">
      <option value="">一覧に表示
      <option value="1" <TMPL_IF hide>selected</TMPL_IF>>一覧には非表示
    </select>
  </dd>
  <dd>※「一覧に非表示」でもタグ検索結果・マイリストには表示されます</dd>
</dl>
<div class="box" id="group">
  <dl>
    <dt>グループ<dd><select name="group">
      <TMPL_LOOP Groups><option value="<TMPL_VAR ID>"<TMPL_IF SELECTED> selected</TMPL_IF>><TMPL_VAR NAME></option></TMPL_LOOP>
    </select>
    <dt>タグ<dd><input type="text" name="tags" value="<TMPL_VAR tags>">
  </dl>
</div>
<div class="box in-toc" id="name-form" data-content-title="ドール名・プレイヤー名">
  <div>
    <dl id="character-name">
      <dt>ドール名
      <dd><input type="text" name="characterName" value="<TMPL_VAR characterName>">
    </dl>
  </div>
  <dl id="player-name">
    <dt>プレイヤー名
    <dd><input type="text" name="playerName" value="<TMPL_VAR playerName>">
  </dl>
</div>
<article>
<section id="area-status" class="box">
  <h2>ステータス</h2>
  <div id="status-left">
    <div id="personal" class="box-union">
      <dl class="box" id="age"><dt>享年<dd><input type="text" name="age" value="<TMPL_VAR age>"></dl>
      <dl class="box" id="gender"><dt>性別<dd><input type="text" name="gender" value="<TMPL_VAR gender>"></dl>
      <dl class="box" id="height"><dt>身長<dd><input type="text" name="height" value="<TMPL_VAR height>"></dl>
      <dl class="box" id="weight"><dt>体重<dd><input type="text" name="weight" value="<TMPL_VAR weight>"></dl>
    </div>
    <table id="class-enhance" class="edit-table">
      <thead>
        <tr><th colspan="5">ポジション・クラス／強化値</th></tr>
      </thead>
    <tbody>
      <tr>
        <th>ポジション</th>
        <td>
          <select name="position">
        <option value="">--</option>
        <option value="アリス" <TMPL_VAR positionSelected1>>アリス</option>
        <option value="ホリック" <TMPL_VAR positionSelected2>>ホリック</option>
        <option value="オートマトン" <TMPL_VAR positionSelected3>>オートマトン</option>
        <option value="ジャンク" <TMPL_VAR positionSelected4>>ジャンク</option>
        <option value="コート" <TMPL_VAR positionSelected5>>コート</option>
        <option value="ソロリティ" <TMPL_VAR positionSelected6>>ソロリティ</option>
      </select>
        </td>
        <th>武装</th><th>変異</th><th>改造</th>
      </tr>
      <tr>
        <th>メインクラス</th>
        <td>
          <select name="mainClass" oninput="calcEnhance()">
        <option value="">--</option>
        <option value="ステーシー" <TMPL_VAR mainClassSelected1>>ステーシー</option>
        <option value="タナトス" <TMPL_VAR mainClassSelected2>>タナトス</option>
        <option value="ゴシック" <TMPL_VAR mainClassSelected3>>ゴシック</option>
        <option value="レクイエム" <TMPL_VAR mainClassSelected4>>レクイエム</option>
        <option value="バロック" <TMPL_VAR mainClassSelected5>>バロック</option>
        <option value="ロマネスク" <TMPL_VAR mainClassSelected6>>ロマネスク</option>
        <option value="サイケデリック" <TMPL_VAR mainClassSelected7>>サイケデリック</option>
      </select>
        </td>
        <td id="main-class-arms"><TMPL_VAR mainClassArms></td>
        <td id="main-class-mutate"><TMPL_VAR mainClassMutate></td>
        <td id="main-class-modify"><TMPL_VAR mainClassModify></td>
      </tr>
      <tr>
        <th>サブクラス</th>
        <td>
          <select name="subClass" oninput="calcEnhance()">
        <option value="">--</option>
        <option value="ステーシー" <TMPL_VAR subClassSelected1>>ステーシー</option>
        <option value="タナトス" <TMPL_VAR subClassSelected2>>タナトス</option>
        <option value="ゴシック" <TMPL_VAR subClassSelected3>>ゴシック</option>
        <option value="レクイエム" <TMPL_VAR subClassSelected4>>レクイエム</option>
        <option value="バロック" <TMPL_VAR subClassSelected5>>バロック</option>
        <option value="ロマネスク" <TMPL_VAR subClassSelected6>>ロマネスク</option>
        <option value="サイケデリック" <TMPL_VAR subClassSelected7>>サイケデリック</option>
      </select>
        </td>
        <td id="sub-class-arms"><TMPL_VAR subClassArms></td>
        <td id="sub-class-mutate"><TMPL_VAR subClassMutate></td>
        <td id="sub-class-modify"><TMPL_VAR subClassModify></td>
      </tr>
      <tr>
        <th colspan="2">任意選択ボーナス</th>
        <td class="radio"><input type="radio" name="enhanceAny" value="arms" oninput="calcEnhance()"<TMPL_IF enhanceAnyArms> checked</TMPL_IF>>+1</td>
        <td class="radio"><input type="radio" name="enhanceAny" value="mutate" oninput="calcEnhance()"<TMPL_IF enhanceAnyMutate> checked</TMPL_IF>>+1</td>
        <td class="radio"><input type="radio" name="enhanceAny" value="modify" oninput="calcEnhance()"<TMPL_IF enhanceAnyModify> checked</TMPL_IF>>+1</td>
      </tr>
      <tr>
        <th colspan="2">成長</th>
        <td><input type="number" name="enhanceArmsGrow" value="<TMPL_VAR enhanceArmsGrow>" oninput="calcEnhance()"></td>
        <td><input type="number" name="enhanceMutateGrow" value="<TMPL_VAR enhanceMutateGrow>" oninput="calcEnhance()"></td>
        <td><input type="number" name="enhanceModifyGrow" value="<TMPL_VAR enhanceModifyGrow>" oninput="calcEnhance()"></td>
      </tr>
      <tr>
        <th colspan="2">合計</th>
        <td id="enhance-arms-total"><TMPL_VAR enhanceArmsTotal></td>
        <td id="enhance-mutate-total"><TMPL_VAR enhanceMutateTotal></td>
        <td id="enhance-modify-total"><TMPL_VAR enhanceModifyTotal></td>
      </tr>
    </tbody>
    </table>
    <input type="hidden" name="enhanceArms" id="enhance-arms-base" value="<TMPL_VAR enhanceArms>">
    <input type="hidden" name="enhanceMutate" id="enhance-mutate-base" value="<TMPL_VAR enhanceMutate>">
    <input type="hidden" name="enhanceModify" id="enhance-modify-base" value="<TMPL_VAR enhanceModify>">
    <dl>
      <dt>行動値<dd><input type="number" name="actionPoint" value="<TMPL_VAR actionPoint>">
    </dl>
  </div>
  <div id="status-right">
    <TMPL_VAR imageForm>
  </div>
</section>
<section id="effect" class="box">
  <h2>エフェクト</h2>
  <input type="hidden" name="effectNum" value="<TMPL_VAR effectNum>">
  <table class="edit-table line-tbody no-border-cells" id="effect-table">
    <thead id="effect-head">
      <tr><th><th>名称<th>LV<th>タイミング<th>技能<th>難易度<th>対象<th>射程<th>侵蝕値<th>制限</tr>
    </thead>
<TMPL_LOOP EffectRows>
    <tbody id="effect-row<TMPL_VAR ID>">
      <tr>
        <td rowspan="2" class="handle"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Name" value="<TMPL_VAR NAME>" placeholder="名称"></td>
        <td><input type="number" name="effect<TMPL_VAR ID>Lv" value="<TMPL_VAR LV>" min="0" placeholder="Lv"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Timing" value="<TMPL_VAR TIMING>" placeholder="タイミング"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Skill" value="<TMPL_VAR SKILL>" placeholder="技能"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Dfclty" value="<TMPL_VAR DFCLTY>" placeholder="難易度"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Target" value="<TMPL_VAR TARGET>" placeholder="対象"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Range" value="<TMPL_VAR RANGE>" placeholder="射程"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Encroach" value="<TMPL_VAR ENCROACH>" placeholder="侵蝕値"></td>
        <td><input type="text" name="effect<TMPL_VAR ID>Restrict" value="<TMPL_VAR RESTRICT>" placeholder="制限"></td>
      </tr>
      <tr>
        <td colspan="9">
          <div>
            <b>種別</b><select name="effect<TMPL_VAR ID>Type">
              <option value="">--</option>
              <option value="auto"  <TMPL_IF TYPE_AUTO>selected</TMPL_IF>>自動</option>
              <option value="dlois" <TMPL_IF TYPE_DLOIS>selected</TMPL_IF>>Dロイス</option>
              <option value="easy"  <TMPL_IF TYPE_EASY>selected</TMPL_IF>>イージー</option>
              <option value="enemy" <TMPL_IF TYPE_ENEMY>selected</TMPL_IF>>エネミー</option>
            </select>
            <b class="small">経験点修正</b><input type="number" name="effect<TMPL_VAR ID>Exp" value="<TMPL_VAR EXP>">
            <b>効果</b><input type="text" name="effect<TMPL_VAR ID>Note" value="<TMPL_VAR NOTE>">
          </div>
        </td>
      </tr>
    </tbody>
</TMPL_LOOP>
  </table>
  <div class="add-del-button"><a onclick="addEffect()">▼</a><a onclick="delEffect()">▲</a></div>
  <template id="effect-template">
    <tbody id="effect-rowTMPL">
      <tr>
        <td rowspan="2" class="handle"></td>
        <td><input type="text" name="effectNameTMPL" placeholder="名称"></td>
        <td><input type="number" name="effectLvTMPL" min="0" placeholder="Lv"></td>
        <td><input type="text" name="effectTimingTMPL" placeholder="タイミング"></td>
        <td><input type="text" name="effectSkillTMPL" placeholder="技能"></td>
        <td><input type="text" name="effectDfcltyTMPL" placeholder="難易度"></td>
        <td><input type="text" name="effectTargetTMPL" placeholder="対象"></td>
        <td><input type="text" name="effectRangeTMPL" placeholder="射程"></td>
        <td><input type="text" name="effectEncroachTMPL" placeholder="侵蝕値"></td>
        <td><input type="text" name="effectRestrictTMPL" placeholder="制限"></td>
      </tr>
      <tr>
        <td colspan="9">
          <div>
            <b>種別</b><select name="effectTypeTMPL">
              <option value="">--</option>
              <option value="auto">自動</option>
              <option value="dlois">Dロイス</option>
              <option value="easy">イージー</option>
              <option value="enemy">エネミー</option>
            </select>
            <b class="small">経験点修正</b><input type="number" name="effectExpTMPL">
            <b>効果</b><input type="text" name="effectNoteTMPL">
          </div>
        </td>
      </tr>
    </tbody>
  </template>
</section>
<div class="box trash-box" id="effect-trash">
  <h2><span class="material-symbols-outlined">delete</span><span class="shorten">削除エフェクト</span></h2>
  <table class="edit-table line-tbody" id="effect-trash-table"></table>
  <i class="material-symbols-outlined close-button" onclick="document.getElementById('effect-trash').style.display = 'none';">close</i>
</div>
<section id="memory" class="box">
  <h2>記憶のカケラ</h2>
  <input type="hidden" name="memoryNum" value="<TMPL_VAR memoryNum>">
  <table class="edit-table no-border-cells" id="memory-table">
    <thead>
      <tr><th>名称<th class="left">内容</tr>
    </thead>
    <tbody id="memory-list">
<TMPL_LOOP MemoryRows>
      <tr id="memory-row<TMPL_VAR ID>">
        <td><input type="text" name="memoryName<TMPL_VAR ID>" value="<TMPL_VAR NAME>"></td>
        <td><input type="text" name="memoryNote<TMPL_VAR ID>" value="<TMPL_VAR NOTE>"></td>
      </tr>
</TMPL_LOOP>
    </tbody>
  </table>
  <div class="add-del-button"><a onclick="addMemory()">▼</a><a onclick="delMemory()">▲</a></div>
  <template id="memory-template">
    <tr id="memory-rowTMPL">
      <td><input type="text" name="memoryNameTMPL"></td>
      <td><input type="text" name="memoryNoteTMPL"></td>
    </tr>
  </template>
</section>
<section id="fetters" class="box">
  <h2>未練／狂気</h2>
  <table class="edit-table no-border-cells" id="fetters-table">
    <thead>
      <tr><th>対象<th>未練<th>狂気点<th>発狂効果<th>発狂内容</tr>
    </thead>
    <tbody>
<TMPL_LOOP FetterRows>
      <tr>
        <td><input type="text" name="fetterTarget<TMPL_VAR ID>" value="<TMPL_VAR TARGET>"></td>
        <td><span class="fetter-to">への</span><select name="fetterNote<TMPL_VAR ID>" data-value="<TMPL_VAR NOTE>" oninput="setFetter(<TMPL_VAR ID>)"></select></td>
        <td><input type="number" name="fetterPoint<TMPL_VAR ID>" value="<TMPL_VAR POINT>" min="0" max="4"></td>
        <td><input type="text" name="fetterEffect<TMPL_VAR ID>" value="<TMPL_VAR EFFECT>" readonly></td>
        <td><input type="text" name="fetterEffectNote<TMPL_VAR ID>" value="<TMPL_VAR EFFECT_NOTE>"></td>
      </tr>
</TMPL_LOOP>
    </tbody>
  </table>
</section>
<section id="free-note" class="box">
  <h2>自由メモ</h2>
  <textarea name="freeNote" rows="4"><TMPL_VAR freeNote></textarea>
</section>
<p class="submit"><input type="submit" value="保存"></p>
</article>
</form>
<div class="back-button"><a href="./">⏎</a></div>
</main>
<script src="<TMPL_VAR coreDir>/lib/edit.js?<TMPL_VAR ver>" defer></script>
<script src="<TMPL_VAR coreDir>/lib/nc/edit-chara.js?<TMPL_VAR ver>" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  if(document.sheet){
    if(document.sheet.mainClass) document.sheet.mainClass.value = '<TMPL_VAR mainClass>';
    if(document.sheet.subClass)  document.sheet.subClass.value  = '<TMPL_VAR subClass>';
    const any = '<TMPL_VAR enhanceAny>';
    if(any){
      const r = document.querySelector('input[name="enhanceAny"][value="'+any+'"]');
      if(r){ r.checked = true; }
    }
  }
});
</script>
<footer>
  <p class="notes">©Incog.Lab「永い後日談のネクロニカ」</p>
  <p class="copyright">©<a href="https://yutorize.2-d.jp">ゆとらいず工房</a>「ゆとシートⅡ」ver.<TMPL_VAR ver></p>
</footer>
</body>
</html>
